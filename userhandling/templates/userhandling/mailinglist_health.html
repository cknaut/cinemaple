{% extends 'logged_in_base.html' %}
{% load static %}
{% load shuffle %}


{% block css_imports %}
<link rel="stylesheet" type="text/css" href="{% static 'userhandling/css/youtubemodal.css' %}">
<script type="text/javascript" src="{% static 'userhandling/lib/starrating/jquery.raty.js' %}" <></script>
<link rel="stylesheet" type="text/css" href="{% static 'userhandling/lib/starrating/jquery.raty.css' %}" />
<link rel="stylesheet" type="text/css" href="{% static 'userhandling/css/youtubemodal.css' %}">
<link href="{% static 'userhandling/css/val_succ_modal.css' %}" rel="stylesheet">
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.19/js/jquery.dataTables.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.18/datatables.min.css" />
<script type="text/javascript" src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.js"></script>
<link rel="stylesheet" type="text/css"
  href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css">
<link href="{% static 'userhandling/lib/animate/animate.css' %}" rel="stylesheet">
<link href="{% static 'userhandling/lib/mdb/css/mdb.lite.css' %}" rel="stylesheet">


<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.css"
  type="text/css" media="all" rel="stylesheet">
<link href="/static/bootstrap_datepicker_plus/css/datepicker-widget.css" type="text/css" media="all" rel="stylesheet">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js">
</script>
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js">
</script>
<script type="text/javascript" src="/static/bootstrap_datepicker_plus/js/datepicker-widget.js"></script>
<script src="https://cloud.tinymce.com/5/tinymce.min.js?apiKey=pqiihwpzf32ctpl7kn59g5ivcztnma4qormn1elar66gqrw4">
</script>

<style>
    @font-face {
        font-family: "raty";
        font-style: normal;
        font-weight: normal;
        src: url("{% static 'userhandling/lib/starrating/fonts/raty.eot' %}");
        src: url("{% static 'userhandling/lib/starrating/fonts/raty.eot?#iefix' %}") format("embedded-opentype");
        src: url("{% static 'userhandling/lib/starrating/fonts/raty.svg#raty' %}") format("svg");
        src: url("{% static 'userhandling/lib/starrating/fonts/raty.ttf' %}") format("truetype");
        src: url("{% static 'userhandling/lib/starrating/fonts/raty.woff' %}") format("woff");
    }
</style>


{% endblock%}


{% block header %}<header id="header">
  <div class="container">

    <div id="logo" class="pull-left">
      <!-- Uncomment below if you prefer to use a text logo -->
      <!-- <h1><a href="#hero">Cinemaple</a></h1> -->
      <a href="{% url 'index' %}"><img   src="{% static 'userhandling/img/logos/logo_cinemaple.png' %}" alt="" title="" height="40" /></img></a>
    </div>

    <nav id="nav-menu-container">
      <ul class="nav-menu">
        <li class="menu" ><a href={% url 'curr_mov_nights' %}>Current Movie Night</a></li>
        <li class="menu" ><a href={% url 'past_mov_nights' %}>Past Movie Nights</a></li>

        {% if request.user.is_staff %}
        <li class="menu-has-children menu-active"><a href="">Admin Actions</a>
          <ul>
            <li><a href={% url 'add_movie_night' %}>Add Movie Night</a></li>
            <li><a href={% url 'man_mov_nights' %}>Manage Movie Nights</a></li>
            <li><a href={% url 'ml_health' %}>Mailing List Healths</a></li>
          </ul>

        {% endif %}
      {% if user.is_authenticated %}
      <li class="menu-has-children "><a href="">User Setting</a>
          <ul>
            <li><a href={% url 'change_password' %}>Change Password</a></li>
            <li><a href={% url 'change_profile' %} >Change Profile</a></li>
          </ul>
      <li>  <a href={% url 'logout'%} data-toggle="modal" data-target="#logoutmodal" style="font-weight:bold; color:#af353b" class="btn-get-started"  >Logout</a> </li>


      {% else %}
      <li>  <a href="{% url 'login' %}" style="font-weight:bold; color:#af353b" class="btn-get-started">Login</a> </li>
    {% endif %}
      </ul>
    </nav><!-- #nav-menu-container -->
  </div>
</header><!-- #header -->
{% endblock %}


{% block main %}
<div class="container-fluid">

    <!-- Content Row -->
    <div class="row">

        <!-- Earnings (Monthly) Card Example -->
        <!-- Area Chart -->
        <div class="col-xl-12 col-lg-12">
            <div class="card shadow mb-4">
                <!-- Card Header - Dropdown -->
                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                    <h6 class="m-0 font-weight-bold text-primary">Mailing List Health</h6>
                </div>
                <!-- Card Body -->
                <div class="card-body">

                        <div class="row3">
                                <div class="col-xl-3 col-lg-3">
                                Mailchimp audience ID:
                                </div>

                                <div class="col-xl-9 col-lg-93">
                                    {{mc_id}}
                                </div>
                        </div>



                        <div class="row3">
                                <div class="col-xl-3 col-lg-3">
                                Response Status:
                                </div>

                                <div class="col-xl-9 col-lg-93">
                                    {{status|safe}}
                                </div>
                        </div>

                        {% if statusok %}

                        <div class="row3">
                                <div class="col-xl-3 col-lg-3">
                                Mailing List Health:
                                </div>

                                <div class="col-xl-9 col-lg-93">
                                    {{health|safe}}
                                </div>
                        </div>



                        <div class="row3">
                                <div class="col-xl-3 col-lg-3">
                               Subscribed Members ({{ subs|length }} total):
                                </div>

                                <div class="col-xl-9 col-lg-9">
                                {% for  email in subs %}
                                <div class="row1">
                                {{email|safe}}
                                </div>
                                {% endfor %}
                                </div>
                        </div>

                        <div class="row3">
                                <div class="col-xl-3 col-lg-3">
                               Unsubscribed Members ({{ usubs|length }}  total):
                                </div>

                                <div class="col-xl-9 col-lg-9">
                                        {% for  email in usubs %}
                                        <div class="row1">
                                                {{email|safe}}
                                            </div>
                                        {% endfor %}
                                </div>
                        </div>

                        <div class="row3">
                                <div class="col-xl-3 col-lg-3">
                               Active Users ({{ user_emails|length }}  total):
                                </div>

                                <div class="col-xl-9 col-lg-9">
                                        {% for  email in user_emails %}
                                        <div class="row1">
                                                {{email|safe}}
                                            </div>

                                        {% endfor %}
                                </div>
                        </div>


                        <div class="row3">
                                <div class="col-xl-3 col-lg-3">
                               Active users not in Mailchimp list ({{ users_not_in_mc|length }}  total):
                                </div>

                                <div class="col-xl-9 col-lg-9">
                                        {% for  email in users_not_in_mc %}
                                        <div class="row1">
                                        {{email|safe}}
                                        </div>
                                        {% endfor %}
                                </div>
                        </div>

                        {% endif %}





                </div>
            </div>
        </div>
    </div>
</div>
<!-- /.container-fluid -->
{% endblock %}


{% block modals %}

<div class="modal fade" id="pwchanged" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Password succesfully changed!</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">You can now log in using your new password.
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" type="button" data-dismiss="modal">Cool</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="userchanged" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">User information succesfully changed!</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">Your profile has been updated.
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" type="button" data-dismiss="modal">Cool</button>
            </div>
        </div>
    </div>
</div>

<div id="logoutmodal" class="modal bs-example-modal-sm" tabindex="-1" role="dialog" aria-hidden="true">
<div class="container">
  <div class="col-sm">
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
          <div class="modal-header"><h4>Logout <i class="fa fa-lock"></i></h4></div>
          <div class="modal-body"><i class="fa fa-question-circle"></i> Are you sure you want to log out?</div>
          <div class="modal-footer"><a href={% url 'logout' %} class="btn-get-started"><font color = #af353b>Logout</font></a></div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}


{% block js %}


{% endblock %}